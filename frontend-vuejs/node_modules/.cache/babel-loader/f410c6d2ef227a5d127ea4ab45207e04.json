{"ast":null,"code":"import { mapGetters } from 'vuex';\nimport ProductoService from '@/service/ProductoService';\nimport { FilterMatchMode } from 'primevue/api';\nexport default {\n  name: 'CrudApp',\n\n  data() {\n    return {\n      productos: [],\n      selectedRow: {\n        id: null,\n        nombre: null,\n        descripcion: null,\n        precio: null\n      },\n      editedRow: {\n        id: null,\n        nombre: null,\n        descripcion: null,\n        precio: null\n      },\n      isDisabled: true,\n      filters: {\n        'global': {\n          value: null,\n          matchMode: FilterMatchMode.STARTS_WITH\n        },\n        'nombre': {\n          value: null,\n          matchMode: FilterMatchMode.STARTS_WITH\n        },\n        'descripcion': {\n          value: null,\n          matchMode: FilterMatchMode.CONTAINS\n        },\n        'precio': {\n          value: null,\n          matchMode: FilterMatchMode.CONTAINS\n        }\n      },\n      loading: true\n    };\n  },\n\n  productoService: null,\n\n  created() {\n    this.productoService = new ProductoService();\n    this.initFilters();\n  },\n\n  computed: { ...mapGetters({\n      username: 'username',\n      keycloakToken: 'keycloakToken',\n      keycloakTokenParsed: 'keycloakTokenParsed',\n      axiosConfig: 'axiosConfig',\n      roles: 'roles'\n    })\n  },\n\n  mounted() {\n    if (this.keycloakToken != null) {\n      this.getAll();\n    }\n  },\n\n  watch: {\n    keycloakToken: function (val) {\n      if (val) {\n        this.productoService.getAll(this.axiosConfig).then(response => {\n          this.productos = response.data;\n          this.loading = false;\n        });\n      }\n    }\n  },\n  methods: {\n    save() {\n      try {\n        this.productoService.save(this.editedRow, this.axiosConfig).then(() => {\n          this.$toast.add({\n            severity: 'success',\n            summary: 'Guardando',\n            detail: 'REGISTRO CREADO CORRECTAMENTE. GUARDADO EN BASE DE DATOS',\n            life: 3000\n          });\n          this.getAll();\n          this.isDisabled = true;\n        });\n      } catch (error) {\n        this.$toast.add({\n          severity: 'error',\n          summary: 'Error',\n          detail: 'No se pudo guardar el registro. Por favor, inténtalo de nuevo más tarde.',\n          life: 3000\n        });\n      }\n    },\n\n    create() {\n      this.isDisabled = false;\n      console.log('Hola create');\n      this.editedRow = {\n        id: null,\n        nombre: null,\n        descripcion: null,\n        precio: null\n      };\n    },\n\n    remove() {\n      try {\n        this.productoService.remove(this.editedRow.id, this.axiosConfig).then(() => {\n          this.$toast.add({\n            severity: 'success',\n            summary: 'Eliminando',\n            detail: 'REGISTRO ELIMINADO CORRECTAMENTE. BORRADO EN BASE DE DATOS',\n            life: 3000\n          });\n          this.getAll();\n          this.isDisabled = true;\n        });\n      } catch (error) {\n        this.$toast.add({\n          severity: 'error',\n          summary: 'Error',\n          detail: 'No se pudo eliminar el registro. Por favor, inténtalo de nuevo más tarde.',\n          life: 3000\n        });\n      }\n    },\n\n    getAll() {\n      this.productoService.getAll(this.axiosConfig).then(response => {\n        this.productos = response.data;\n      });\n    },\n\n    onRowSelect(event) {\n      this.editedRow = Object.assign({}, event.data);\n      this.isDisabled = false;\n    },\n\n    initFilters() {\n      this.filters = {\n        'global': {\n          value: null,\n          matchMode: FilterMatchMode.CONTAINS\n        }\n      };\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["mapGetters","ProductoService","FilterMatchMode","name","data","productos","selectedRow","id","nombre","descripcion","precio","editedRow","isDisabled","filters","value","matchMode","STARTS_WITH","CONTAINS","loading","productoService","created","initFilters","computed","username","keycloakToken","keycloakTokenParsed","axiosConfig","roles","mounted","getAll","watch","val","then","response","methods","save","$toast","add","severity","summary","detail","life","error","create","console","log","remove","onRowSelect","event","Object","assign"],"sourceRoot":"","sources":["C:\\Users\\emalc\\OneDrive\\Escritorio\\CRUD_keycloak_primeVue\\keycloak-workshop\\frontend-vuejs\\src\\componentes\\ProductoDatatable.vue"],"sourcesContent":["<template>\r\n  <div style=\"margin: 0 auto; width: 80%\">\r\n    <p_panel header=\"Lista de Productos\">\r\n      <p:dataTable :value=\"productos\" :paginator=\"true\" :rows=\"10\" v-model:selection=\"selectedRow\"\r\n        class=\"p-datatable-productos\" @row-click=\"onRowSelect\" selectionMode=\"single\" dataKey=\"id\"  :loading=\"loading\"\r\n        paginatorTemplate=\"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown\"\r\n        :rowsPerPageOptions=\"[10, 20, 50]\" responsiveLayout=\"scroll\" filterDisplay=\"menu\" v-model:filters=\"filters\"\r\n        :globalFilterFields=\"['nombre', 'descripcion', 'precio']\"\r\n        currentPageReportTemplate=\"Mostrando {first} a {last} de {totalRecords}\">\r\n        <template #header>\r\n          <div class=\"flex justify-content-end\">\r\n            <span class=\"p-input-icon-left \">\r\n              <i class=\"pi pi-search\" />\r\n              <p:inputText v-model=\"filters['global'].value\" placeholder=\"Buscar...\" />\r\n            </span>\r\n          </div>\r\n        </template>\r\n        <template #empty>\r\n          No hay productos disponibles.\r\n        </template>\r\n        <template #loading>\r\n          Cargando productos. por favor, espera.\r\n        </template>\r\n        <p_column field=\"nombre\" header=\"Nombre\" style=\"min-width:12rem\">\r\n          <template #body=\"{ data }\">\r\n            {{ data.nombre }}\r\n          </template>\r\n          <template #filter=\"{ filterModel, filterCallback }\">\r\n            <p:inputText type=\"text\" v-model=\"filterModel.value\" @keydown.enter=\"filterCallback()\" class=\"p-column-filter\"\r\n              :placeholder=\"`Buscar por nombre - `\" v-tooltip.top.focus=\"'Hit enter key to filter'\" />\r\n          </template>\r\n        </p_column>\r\n        <p_column field=\"nombre\" header=\"Nombre\"></p_column>\r\n        <p_column field=\"descripcion\" header=\"Descripción\"></p_column>\r\n        <p_column field=\"precio\" header=\"Precio\"></p_column>\r\n\r\n      </p:dataTable>\r\n    </p_panel>\r\n  </div>\r\n\r\n  <p_toast></p_toast>\r\n\r\n  <p_panel style=\"margin-bottom: 20px;margin: 0 auto; width: 80%\">\r\n    <div style=\"display: inline-block; margin-right: 10px;\">\r\n      <label for=\"nombre\" style=\"display: block;\">Nombre</label>\r\n      <p:inputText id=\"nombre\" type=\"text\" v-model=\"this.editedRow.nombre\" :disabled=\"isDisabled\"\r\n        style=\"width: 200px;\" />\r\n    </div>\r\n\r\n    <div style=\"display: inline-block; margin-right: 10px;\">\r\n      <label for=\"descripcion\" style=\"display: block;\">Descripción</label>\r\n      <p:inputText id=\"descripcion\" type=\"text\" v-model=\"this.editedRow.descripcion\" :disabled=\"isDisabled\"\r\n        style=\"width: 200px;\" />\r\n    </div>\r\n\r\n    <div style=\"display: inline-block; margin-right: 10px;\">\r\n      <label for=\"precio\" style=\"display: block;\">Precio</label>\r\n      <p:inputText id=\"precio\" type=\"text\" v-model=\"this.editedRow.precio\" :disabled=\"isDisabled\"\r\n        style=\"width: 200px;\" />\r\n    </div>\r\n  </p_panel>\r\n  <div v-if=\"this.roles.includes('SUPER_USER')\">\r\n    <p_panel style=\"margin-bottom: 20px;margin: 0 auto; width: 80%\">\r\n      <div class=\"center-buttons\" style=\"margin: 0 auto; width: 80%; text-align: center;\">\r\n        <p:commandButton style=\"margin-right: 10px;\" label=\"Nuevo\" @click=\"create\" class=\"p-button-success mr-2\"\r\n          icon=\"pi pi-plus\"></p:commandButton>\r\n        <p:commandButton style=\"margin-right: 10px;\" label=\"Guardar\" @click=\"save\" icon=\"pi pi-save\" update=\"nombre\">\r\n        </p:commandButton>\r\n        <p:commandButton style=\"margin-right: 10px;\" label=\"Eliminar\" @click=\"remove\" class=\"p-button-danger\"\r\n          icon=\"pi pi-trash\"></p:commandButton>\r\n        <p:commandButton style=\"margin-right: 10px;\" label=\"Refrescar\" @click=\"getAll\" class=\"p-button-danger\"\r\n          icon=\"pi pi-refresh\"></p:commandButton>\r\n      </div>\r\n    </p_panel>\r\n\r\n  </div>\r\n\r\n\r\n\r\n  <p_toast></p_toast>\r\n</template>\r\n\r\n\r\n<script>\r\n\r\nimport { mapGetters } from 'vuex';\r\nimport ProductoService from '@/service/ProductoService';\r\nimport {FilterMatchMode} from 'primevue/api';\r\n\r\nexport default {\r\n  name: 'CrudApp',\r\n  data() {\r\n    return {\r\n      productos: [],\r\n      selectedRow: {\r\n        id: null,\r\n        nombre: null,\r\n        descripcion: null,\r\n        precio: null\r\n      },\r\n      editedRow: {\r\n        id: null,\r\n        nombre: null,\r\n        descripcion: null,\r\n        precio: null\r\n      },\r\n      isDisabled: true,\r\n      filters: {\r\n        'global': { value: null, matchMode: FilterMatchMode.STARTS_WITH },\r\n        'nombre': { value: null, matchMode: FilterMatchMode.STARTS_WITH },\r\n        'descripcion': { value: null, matchMode: FilterMatchMode.CONTAINS },\r\n        'precio': { value: null, matchMode: FilterMatchMode.CONTAINS },\r\n      },\r\n      loading: true\r\n    }\r\n  },\r\n  productoService: null,\r\n  created() {\r\n    this.productoService = new ProductoService();\r\n    this.initFilters();\r\n\r\n  },\r\n  computed: {\r\n    ...mapGetters({\r\n      username: 'username',\r\n      keycloakToken: 'keycloakToken',\r\n      keycloakTokenParsed: 'keycloakTokenParsed',\r\n      axiosConfig: 'axiosConfig',\r\n      roles: 'roles',\r\n    })\r\n  },\r\n  mounted() {\r\n    if (this.keycloakToken != null) {\r\n      this.getAll();\r\n    }\r\n\r\n  },\r\n  watch: {\r\n    keycloakToken: function (val) {\r\n      if (val) {\r\n        this.productoService.getAll(this.axiosConfig).then(response => {\r\n          this.productos = response.data;\r\n          this.loading= false;\r\n        });\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    save() {\r\n      try {\r\n        this.productoService.save(this.editedRow, this.axiosConfig).then(() => {\r\n          this.$toast.add({ severity: 'success', summary: 'Guardando', detail: 'REGISTRO CREADO CORRECTAMENTE. GUARDADO EN BASE DE DATOS', life: 3000 })\r\n          this.getAll();\r\n          this.isDisabled = true;\r\n        });\r\n      } catch (error) {\r\n        this.$toast.add({ severity: 'error', summary: 'Error', detail: 'No se pudo guardar el registro. Por favor, inténtalo de nuevo más tarde.', life: 3000 });\r\n      }\r\n    },\r\n    create() {\r\n      this.isDisabled = false;\r\n      console.log('Hola create')\r\n      this.editedRow = {\r\n        id: null,\r\n        nombre: null,\r\n        descripcion: null,\r\n        precio: null\r\n      }\r\n    },\r\n    remove() {\r\n      try {\r\n        this.productoService.remove(this.editedRow.id, this.axiosConfig).then(() => {\r\n          this.$toast.add({ severity: 'success', summary: 'Eliminando', detail: 'REGISTRO ELIMINADO CORRECTAMENTE. BORRADO EN BASE DE DATOS', life: 3000 })\r\n          this.getAll();\r\n          this.isDisabled = true;\r\n        });\r\n      } catch (error) {\r\n        this.$toast.add({ severity: 'error', summary: 'Error', detail: 'No se pudo eliminar el registro. Por favor, inténtalo de nuevo más tarde.', life: 3000 });\r\n      }\r\n    },\r\n    getAll() {\r\n      this.productoService.getAll(this.axiosConfig).then(response => {\r\n        this.productos = response.data;\r\n      });\r\n    },\r\n    onRowSelect(event) {\r\n      this.editedRow = Object.assign({}, event.data);\r\n      this.isDisabled = false;\r\n    },\r\n    initFilters() {\r\n      this.filters = {\r\n        'global': { value: null, matchMode: FilterMatchMode.CONTAINS },\r\n\r\n      }\r\n    }\r\n\r\n  }\r\n\r\n}\r\n\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n::v-deep(.p-paginator) {\r\n    .p-paginator-current {\r\n        margin-left: auto;\r\n    }\r\n}\r\n\r\n::v-deep(.p-progressbar) {\r\n    height: .5rem;\r\n    background-color: #D8DADC;\r\n\r\n    .p-progressbar-value {\r\n        background-color: #607D8B;\r\n    }\r\n}\r\n\r\n::v-deep(.p-datepicker) {\r\n    min-width: 25rem;\r\n\r\n    td {\r\n        font-weight: 400;\r\n    }\r\n}\r\n::v-deep(.p-datatable.p-datatable-productos) {\r\n  .p-datatable-header {\r\n    padding: 1rem;\r\n    text-align: left;\r\n    font-size: 1.5rem;\r\n  }\r\n\r\n  .p-paginator {\r\n    padding: 1rem;\r\n  }\r\n\r\n  .p-datatable-thead>tr>th {\r\n    text-align: left;\r\n  }\r\n\r\n  .p-datatable-tbody>tr>td {\r\n    cursor: auto;\r\n  }\r\n\r\n  .p-dropdown-label:not(.p-placeholder) {\r\n    text-transform: uppercase;\r\n  }\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}