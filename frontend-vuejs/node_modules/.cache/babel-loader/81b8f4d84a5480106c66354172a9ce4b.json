{"ast":null,"code":"import { reactive, onMounted, nextTick } from 'vue';\n\n/**\r\n * Función TableBean composable para el uso de la aplicación frontend\r\n * @param {*} service \r\n * @param {*} axiosConfig \r\n * @returns \r\n */\nexport function tableBean(service, axiosConfig) {\n  const state = reactive({\n    editedRow: null,\n    selectedRow: null,\n    list: [],\n    disabled: false\n  });\n\n  /**\r\n   * Carga los datos de la tabla desde el servidor\r\n   * @returns {Promise<void>}\r\n   */\n  const list = async () => {\n    console.log('Entrando en list de tableBean');\n    try {\n      const response = await service.getAll(axiosConfig);\n      state.list = response.data;\n    } catch (error) {\n      console.log(error);\n    }\n  };\n  onMounted(list);\n\n  //***CREATE************/\n  const create = () => {\n    state.disabled = false;\n    state.editedRow = null;\n  };\n\n  //***SAVE*************/\n  const save = async () => {\n    console.log('Dentro del save del composable');\n    console.log(state.editedRow);\n    try {\n      await service.save(state.editedRow, axiosConfig);\n      this.$toast.add({\n        severity: 'success',\n        summary: 'Guardando',\n        detail: 'REGISTRO CREADO CORRECTAMENTE. GUARDADO EN BASE DE DATOS',\n        life: 3000\n      });\n      await list();\n      state.disabled = true;\n    } catch (error) {\n      console.log('catch');\n      console.log(error);\n      if (error.response.status === 400) {\n        const errorMessage = error.response.data;\n        this.$toast.add({\n          severity: 'error',\n          summary: 'Error',\n          detail: errorMessage,\n          life: 3000\n        });\n      } else {\n        this.$toast.add({\n          severity: 'error',\n          summary: 'Error',\n          detail: 'No se pudo guardar el registro. Por favor, inténtalo de nuevo más tarde.',\n          life: 3000\n        });\n      }\n    }\n  };\n  //***ROWSELECTLISTENER******/\n  const rowSelectListener = async selectedRow => {\n    console.log('Dentro del rowSelectListener del composable');\n    state.selectedRow = selectedRow;\n    state.editedRow = Object.assign({}, selectedRow); // Aquí se clona el objeto\n    await nextTick(); // Espera a que se actualice el valor de state.selectedRow\n\n    console.log('SelectedRow:', state.selectedRow);\n    console.log('EditedRow:', state.editedRow);\n  };\n\n  /**\r\n  * Elimina una fila de la tabla\r\n  * @param {Object} rowToDelete - La fila a eliminar\r\n  * @returns {Promise<void>}\r\n  */\n  const remove = async rowToDelete => {\n    try {\n      await service.remove(rowToDelete.id, axiosConfig);\n      state.list = await service.getAll(axiosConfig); // actualiza la lista\n      state.disabled = true;\n    } catch (error) {\n      console.log(error);\n    }\n  };\n  return {\n    state,\n    save,\n    remove,\n    create,\n    list,\n    rowSelectListener\n  };\n}","map":{"version":3,"names":["reactive","onMounted","nextTick","tableBean","service","axiosConfig","state","editedRow","selectedRow","list","disabled","console","log","response","getAll","data","error","create","save","$toast","add","severity","summary","detail","life","status","errorMessage","rowSelectListener","Object","assign","remove","rowToDelete","id"],"sources":["C:/Users/emalc/OneDrive/Escritorio/CRUD_keycloak_primeVue/keycloak-workshop/frontend-vuejs/src/composables/tableBean.js"],"sourcesContent":["import { reactive, onMounted, nextTick } from 'vue';\r\n\r\n/**\r\n * Función TableBean composable para el uso de la aplicación frontend\r\n * @param {*} service \r\n * @param {*} axiosConfig \r\n * @returns \r\n */\r\nexport function tableBean(service, axiosConfig) {\r\n  const state = reactive({\r\n    editedRow: null,\r\n    selectedRow: null,\r\n    list: [],\r\n    disabled: false,\r\n  });\r\n\r\n  /**\r\n   * Carga los datos de la tabla desde el servidor\r\n   * @returns {Promise<void>}\r\n   */\r\n  const list = async () => {\r\n    console.log('Entrando en list de tableBean');\r\n    try {\r\n      const response = await service.getAll(axiosConfig);\r\n      state.list = response.data;\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  };\r\n\r\n  onMounted(list);\r\n\r\n  //***CREATE************/\r\n  const create = () => {\r\n    state.disabled = false;\r\n    state.editedRow = null;\r\n  };\r\n\r\n  //***SAVE*************/\r\n  const save = async () => {\r\n    console.log('Dentro del save del composable');\r\n    console.log(state.editedRow);\r\n    try {\r\n      await service.save(state.editedRow, axiosConfig);\r\n      this.$toast.add({\r\n        severity: 'success',\r\n        summary: 'Guardando',\r\n        detail: 'REGISTRO CREADO CORRECTAMENTE. GUARDADO EN BASE DE DATOS',\r\n        life: 3000\r\n      });\r\n      await list();\r\n      state.disabled = true;\r\n    } catch (error) {\r\n      console.log('catch');\r\n      console.log(error);\r\n      if (error.response.status === 400) {\r\n        const errorMessage = error.response.data;\r\n        this.$toast.add({\r\n          severity: 'error',\r\n          summary: 'Error',\r\n          detail: errorMessage,\r\n          life: 3000\r\n        });\r\n      } else {\r\n        this.$toast.add({\r\n          severity: 'error',\r\n          summary: 'Error',\r\n          detail: 'No se pudo guardar el registro. Por favor, inténtalo de nuevo más tarde.',\r\n          life: 3000\r\n        });\r\n      }\r\n    }\r\n  };\r\n  //***ROWSELECTLISTENER******/\r\n  const rowSelectListener = async (selectedRow) => {\r\n    console.log('Dentro del rowSelectListener del composable');\r\n    state.selectedRow = selectedRow;\r\n    state.editedRow = Object.assign({}, selectedRow); // Aquí se clona el objeto\r\n    await nextTick(); // Espera a que se actualice el valor de state.selectedRow\r\n\r\n    console.log('SelectedRow:', state.selectedRow);\r\n    console.log('EditedRow:', state.editedRow);\r\n\r\n  };\r\n\r\n  /**\r\n * Elimina una fila de la tabla\r\n * @param {Object} rowToDelete - La fila a eliminar\r\n * @returns {Promise<void>}\r\n */\r\n  const remove = async (rowToDelete) => {\r\n    try {\r\n      await service.remove(rowToDelete.id, axiosConfig);\r\n      state.list = await service.getAll(axiosConfig); // actualiza la lista\r\n      state.disabled = true;\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  };\r\n\r\n\r\n\r\n  return {\r\n    state,\r\n    save,\r\n    remove,\r\n    create,\r\n    list,\r\n    rowSelectListener\r\n\r\n  };\r\n}\r\n"],"mappings":"AAAA,SAASA,QAAQ,EAAEC,SAAS,EAAEC,QAAQ,QAAQ,KAAK;;AAEnD;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASC,SAASA,CAACC,OAAO,EAAEC,WAAW,EAAE;EAC9C,MAAMC,KAAK,GAAGN,QAAQ,CAAC;IACrBO,SAAS,EAAE,IAAI;IACfC,WAAW,EAAE,IAAI;IACjBC,IAAI,EAAE,EAAE;IACRC,QAAQ,EAAE;EACZ,CAAC,CAAC;;EAEF;AACF;AACA;AACA;EACE,MAAMD,IAAI,GAAG,MAAAA,CAAA,KAAY;IACvBE,OAAO,CAACC,GAAG,CAAC,+BAA+B,CAAC;IAC5C,IAAI;MACF,MAAMC,QAAQ,GAAG,MAAMT,OAAO,CAACU,MAAM,CAACT,WAAW,CAAC;MAClDC,KAAK,CAACG,IAAI,GAAGI,QAAQ,CAACE,IAAI;IAC5B,CAAC,CAAC,OAAOC,KAAK,EAAE;MACdL,OAAO,CAACC,GAAG,CAACI,KAAK,CAAC;IACpB;EACF,CAAC;EAEDf,SAAS,CAACQ,IAAI,CAAC;;EAEf;EACA,MAAMQ,MAAM,GAAGA,CAAA,KAAM;IACnBX,KAAK,CAACI,QAAQ,GAAG,KAAK;IACtBJ,KAAK,CAACC,SAAS,GAAG,IAAI;EACxB,CAAC;;EAED;EACA,MAAMW,IAAI,GAAG,MAAAA,CAAA,KAAY;IACvBP,OAAO,CAACC,GAAG,CAAC,gCAAgC,CAAC;IAC7CD,OAAO,CAACC,GAAG,CAACN,KAAK,CAACC,SAAS,CAAC;IAC5B,IAAI;MACF,MAAMH,OAAO,CAACc,IAAI,CAACZ,KAAK,CAACC,SAAS,EAAEF,WAAW,CAAC;MAChD,IAAI,CAACc,MAAM,CAACC,GAAG,CAAC;QACdC,QAAQ,EAAE,SAAS;QACnBC,OAAO,EAAE,WAAW;QACpBC,MAAM,EAAE,0DAA0D;QAClEC,IAAI,EAAE;MACR,CAAC,CAAC;MACF,MAAMf,IAAI,EAAE;MACZH,KAAK,CAACI,QAAQ,GAAG,IAAI;IACvB,CAAC,CAAC,OAAOM,KAAK,EAAE;MACdL,OAAO,CAACC,GAAG,CAAC,OAAO,CAAC;MACpBD,OAAO,CAACC,GAAG,CAACI,KAAK,CAAC;MAClB,IAAIA,KAAK,CAACH,QAAQ,CAACY,MAAM,KAAK,GAAG,EAAE;QACjC,MAAMC,YAAY,GAAGV,KAAK,CAACH,QAAQ,CAACE,IAAI;QACxC,IAAI,CAACI,MAAM,CAACC,GAAG,CAAC;UACdC,QAAQ,EAAE,OAAO;UACjBC,OAAO,EAAE,OAAO;UAChBC,MAAM,EAAEG,YAAY;UACpBF,IAAI,EAAE;QACR,CAAC,CAAC;MACJ,CAAC,MAAM;QACL,IAAI,CAACL,MAAM,CAACC,GAAG,CAAC;UACdC,QAAQ,EAAE,OAAO;UACjBC,OAAO,EAAE,OAAO;UAChBC,MAAM,EAAE,0EAA0E;UAClFC,IAAI,EAAE;QACR,CAAC,CAAC;MACJ;IACF;EACF,CAAC;EACD;EACA,MAAMG,iBAAiB,GAAG,MAAOnB,WAAW,IAAK;IAC/CG,OAAO,CAACC,GAAG,CAAC,6CAA6C,CAAC;IAC1DN,KAAK,CAACE,WAAW,GAAGA,WAAW;IAC/BF,KAAK,CAACC,SAAS,GAAGqB,MAAM,CAACC,MAAM,CAAC,CAAC,CAAC,EAAErB,WAAW,CAAC,CAAC,CAAC;IAClD,MAAMN,QAAQ,EAAE,CAAC,CAAC;;IAElBS,OAAO,CAACC,GAAG,CAAC,cAAc,EAAEN,KAAK,CAACE,WAAW,CAAC;IAC9CG,OAAO,CAACC,GAAG,CAAC,YAAY,EAAEN,KAAK,CAACC,SAAS,CAAC;EAE5C,CAAC;;EAED;AACF;AACA;AACA;AACA;EACE,MAAMuB,MAAM,GAAG,MAAOC,WAAW,IAAK;IACpC,IAAI;MACF,MAAM3B,OAAO,CAAC0B,MAAM,CAACC,WAAW,CAACC,EAAE,EAAE3B,WAAW,CAAC;MACjDC,KAAK,CAACG,IAAI,GAAG,MAAML,OAAO,CAACU,MAAM,CAACT,WAAW,CAAC,CAAC,CAAC;MAChDC,KAAK,CAACI,QAAQ,GAAG,IAAI;IACvB,CAAC,CAAC,OAAOM,KAAK,EAAE;MACdL,OAAO,CAACC,GAAG,CAACI,KAAK,CAAC;IACpB;EACF,CAAC;EAID,OAAO;IACLV,KAAK;IACLY,IAAI;IACJY,MAAM;IACNb,MAAM;IACNR,IAAI;IACJkB;EAEF,CAAC;AACH"},"metadata":{},"sourceType":"module"}