{"ast":null,"code":"import { reactive, nextTick } from 'vue';\n\n/**\r\n * Función TableBean composable para el uso de la aplicación frontend\r\n * @param {*} service \r\n * @param {*} axiosConfig \r\n * @returns \r\n */\nexport function tableBean(service, axiosConfig) {\n  const state = reactive({\n    editedRow: null,\n    selectedRow: null,\n    list: [],\n    isDisabled: false\n  });\n\n  /******CARGA DEL LIST*********/\n  const list = async () => {\n    console.log('Entrando en list de tableBean');\n    try {\n      const response = await service.getAll(axiosConfig);\n      state.list = response.data;\n    } catch (error) {\n      console.log(error);\n    }\n  };\n  // Llamamos a la función list() al exportar la función tableBean\n  list();\n\n  //***CREATE************/\n  const create = () => {\n    state.isDisabled = false;\n    state.editedRow = null;\n  };\n  //***SAVE*************/\n  const save = async () => {\n    console.log('Dentro del save del composable');\n    console.log(state.editedRow);\n    try {\n      this.service.save(this.localEditedRow, this.axiosConfig).then(() => {\n        this.$toast.add({\n          severity: 'success',\n          summary: 'Guardando',\n          detail: 'REGISTRO CREADO CORRECTAMENTE. GUARDADO EN BASE DE DATOS',\n          life: 3000\n        });\n        this.getAll();\n        this.isDisabled = true;\n      }).catch(error => {\n        console.log('primer catch');\n        console.log(error);\n        if (error.response.status === 400) {\n          const errorMessage = error.response.data;\n          this.$toast.add({\n            severity: 'error',\n            summary: 'Error',\n            detail: errorMessage,\n            life: 3000\n          });\n        }\n      });\n    } catch (error) {\n      console.log('segundo catch');\n      console.log(error);\n      this.$toast.add({\n        severity: 'error',\n        summary: 'Error',\n        detail: 'No se pudo guardar el registro. Por favor, inténtalo de nuevo más tarde.',\n        life: 3000\n      });\n    }\n  };\n  //***ROWSELECTLISTENER******/\n  const rowSelectListener = async selectedRow => {\n    console.log('Dentro del rowSelectListener del composable');\n    state.selectedRow = selectedRow;\n    state.editedRow = Object.assign({}, selectedRow); // Aquí se clona el objeto\n    await nextTick(); // Espera a que se actualice el valor de state.selectedRow\n\n    console.log('SelectedRow:', state.selectedRow);\n    console.log('EditedRow:', state.editedRow);\n  };\n\n  //***REMOVE*************/\n  const remove = async rowToDelete => {\n    try {\n      await service.remove(rowToDelete.id, axiosConfig);\n      state.list = await list();\n      state.isDisabled = true;\n    } catch (error) {\n      console.log(error);\n    }\n  };\n  return {\n    state,\n    save,\n    remove,\n    create,\n    list,\n    rowSelectListener\n  };\n}","map":{"version":3,"names":["reactive","nextTick","tableBean","service","axiosConfig","state","editedRow","selectedRow","list","isDisabled","console","log","response","getAll","data","error","create","save","localEditedRow","then","$toast","add","severity","summary","detail","life","catch","status","errorMessage","rowSelectListener","Object","assign","remove","rowToDelete","id"],"sources":["C:/Users/emalc/OneDrive/Escritorio/CRUD_keycloak_primeVue/keycloak-workshop/frontend-vuejs/src/composables/tableBean.js"],"sourcesContent":["import { reactive, nextTick } from 'vue';\r\n\r\n\r\n/**\r\n * Función TableBean composable para el uso de la aplicación frontend\r\n * @param {*} service \r\n * @param {*} axiosConfig \r\n * @returns \r\n */\r\nexport function tableBean(service, axiosConfig) {\r\n  const state = reactive({\r\n    editedRow: null,\r\n    selectedRow: null,\r\n    list: [],\r\n    isDisabled: false,\r\n  });\r\n\r\n/******CARGA DEL LIST*********/\r\n  const list = async () => {\r\n    console.log('Entrando en list de tableBean')\r\n    try {\r\n      const response = await service.getAll(axiosConfig);\r\n      state.list = response.data;\r\n\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  };\r\n  // Llamamos a la función list() al exportar la función tableBean\r\n  list();\r\n\r\n//***CREATE************/\r\n  const create = () => {\r\n    state.isDisabled = false;\r\n    state.editedRow = null;\r\n  };\r\n//***SAVE*************/\r\n  const save = async () => {\r\n    console.log('Dentro del save del composable')\r\n    console.log(state.editedRow);\r\n    try {\r\n      this.service.save(this.localEditedRow, this.axiosConfig).then(() => {\r\n        this.$toast.add({\r\n          severity: 'success',\r\n          summary: 'Guardando',\r\n          detail: 'REGISTRO CREADO CORRECTAMENTE. GUARDADO EN BASE DE DATOS',\r\n          life: 3000\r\n        });\r\n        this.getAll();\r\n        this.isDisabled = true;\r\n      }).catch((error) => {\r\n        console.log('primer catch');\r\n        console.log(error);\r\n        if (error.response.status === 400) {\r\n          const errorMessage = error.response.data;\r\n          this.$toast.add({\r\n            severity: 'error',\r\n            summary: 'Error',\r\n            detail: errorMessage,\r\n            life: 3000\r\n          });\r\n        }\r\n      });\r\n    } catch (error) {\r\n      console.log('segundo catch');\r\n      console.log(error);\r\n      this.$toast.add({\r\n        severity: 'error',\r\n        summary: 'Error',\r\n        detail: 'No se pudo guardar el registro. Por favor, inténtalo de nuevo más tarde.',\r\n        life: 3000\r\n      });\r\n    }\r\n\r\n  };\r\n//***ROWSELECTLISTENER******/\r\n  const rowSelectListener = async (selectedRow) => {\r\n    console.log('Dentro del rowSelectListener del composable');\r\n    state.selectedRow = selectedRow;\r\n    state.editedRow = Object.assign({}, selectedRow); // Aquí se clona el objeto\r\n    await nextTick(); // Espera a que se actualice el valor de state.selectedRow\r\n\r\n    console.log('SelectedRow:', state.selectedRow);\r\n    console.log('EditedRow:', state.editedRow);\r\n\r\n  };\r\n\r\n//***REMOVE*************/\r\n  const remove = async (rowToDelete) => {\r\n    try {\r\n      await service.remove(rowToDelete.id, axiosConfig);\r\n      state.list = await list();\r\n      state.isDisabled = true;\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  };\r\n\r\n  return {\r\n    state,\r\n    save,\r\n    remove,\r\n    create,\r\n    list,\r\n    rowSelectListener\r\n\r\n  };\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}